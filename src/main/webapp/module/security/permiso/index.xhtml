<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:jsf="http://xmlns.jcp.org/jsf">

    <h:form id="formDatos">  
        <p:remoteCommand actionListener="#{permisoBean.table.load()}" name="reloadTable"
                         update="searchkeys,paginator,table"/>
        <div class="card docs">
            <div class="ui-g">
                <div class="ui-g-12" jsf:rendered="#{permisoBean.typeOfView eq 'list'}">
                    <div class="ui-g-2 ui-md-3 ui-lg-6"><span style="font-size: 18px">#{permisoBean.title}</span></div>
                    <div class="ui-g-6 ui-md-9 ui-lg-6" >
                        <div style="float: right;display: inline-block">
                            <p:chips id="searchkeys" value="#{permisoBean.table.searchKeys}" 
                                     style="width: 90%;"/>
                            <span style="width: 10%;cursor: pointer" onclick="reloadTable()"><i onclick="" class="topbar-icon material-icons" >î¢¶</i></span>   
                        </div>
                    </div>
                    <div class="ui-g-2 ui-md-4 ui-lg-6">
                        <p:commandButton value="Crear"  actionListener="#{permisoBean.changeView('create','')}" update=":formDatos"/>
                    </div>

                    <div class="ui-g-12 ui-md-12 ui-lg-6" style="text-align: right">
                        <h:panelGrid columns="3" style="float: right;width: 50%" >
                            <h:panelGroup layout="inline" id="paginator">
                                <h:outputText value="#{permisoBean.table.paginator.rowFirst}-#{permisoBean.table.paginator.rows}"/>
                                <h:outputText value=" / "/>
                                <h:outputText value="#{permisoBean.table.paginator.totalRows}"/>
                            </h:panelGroup>
                            <h:panelGroup layout="inline">
                                <p:commandButton icon="ui-icon-navigate-before" 
                                                 actionListener="#{permisoBean.table.paginator.back()}"
                                                 oncomplete="reloadTable();"/>
                                <p:commandButton icon="ui-icon-navigate-next"
                                                 oncomplete="reloadTable();"
                                                 actionListener="#{permisoBean.table.paginator.next()}"/>
                            </h:panelGroup>
                            <h:panelGroup>
                                <p:commandButton icon="ui-icon-dashboard" 
                                                 actionListener="#{permisoBean.table.activeKanban()}"
                                                 update="table"
                                                 style="border-radius: 2px 2px 2px 2px!important"/>
                                <p:commandButton icon="ui-icon-list" 
                                                 actionListener="#{permisoBean.table.activeList()}"
                                                 update="table"
                                                 style="border-radius: 2px 2px 2px 2px!important"/>
                            </h:panelGroup>
                        </h:panelGrid>
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-12">
                        <div jsf:id="table">
                            <p:dataTable value="#{permisoBean.table.listItems}" var="item" 
                                         rendered="#{permisoBean.table.table}" style="font-size: 12px"
                                         selectionMode="single" selection="#{permisoBean.entidad}"
                                         rowKey="#{item.codigoPerm}">

                                <p:ajax event="rowSelect" listener="#{permisoBean.changeView('view','')}" update=":formDatos"/>

                                <p:column headerText="Permiso" style="font-size: 90%">
                                    <h:outputText value="#{item.nombrePerm}"/>
                                </p:column>
                                <p:column headerText="Detalle" style="font-size: 90%">
                                    <h:outputText value="#{item.detallePerm}"/>
                                </p:column>
                                <p:column headerText="Tipo" style="font-size: 90%">
                                    <h:outputText value="#{item.codigoTiper.nombreTiper}"/>
                                </p:column>
                                <p:column headerText="Permiso Padre" style="font-size: 90%">
                                    <h:outputText value="#{item.codigoPadrePerm.nombrePerm}"/>
                                </p:column>

                            </p:dataTable>
                            <hr jsf:rendered="#{permisoBean.table.kanban}"/>
                            <ui:repeat value="#{permisoBean.table.listItems}" var="item2" rendered="#{permisoBean.table.kanban}">
                                <div class="ui-g-12 ui-md-4 ui-lg-4">
                                    <p:remoteCommand actionListener="#{permisoBean.changeView('view',item2.codigoPerm)}" update=":formDatos" name="item2#{item2.codigoPerm}"/>
                                    <div class="card" style="line-height: 1!important;border: solid 1px #000000;height: 90px;font-size: 11px!important;cursor: pointer;min-width: 250px!important;margin-bottom: 1px"
                                         onclick="item2#{item2.codigoPerm}()">
                                        <h:panelGrid columns="2" style="margin-top: -10px;margin-left: -10px">
                                            <h:panelGrid columns="1">
                                                <span style="font-weight: bold;text-transform: uppercase">#{item2.nombrePerm}</span>
                                                <p>Tipo  : #{item2.codigoTiper.nombreTiper}</p>
                                                <p>Estado: #{item2.estado}</p>
                                            </h:panelGrid>
                                        </h:panelGrid>
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                    </div>
                </div>
                <div class="ui-g-12" jsf:rendered="#{not (permisoBean.typeOfView eq 'list')}">
                    <ui:include src="form.xhtml"/>
                </div>
            </div>
        </div>
        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
            <p:commandButton value="SI" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
            <p:commandButton value="NO" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
        </p:confirmDialog>
    </h:form>

</ui:composition>

